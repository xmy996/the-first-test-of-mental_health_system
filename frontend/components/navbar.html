<!-- 优化的导航栏组件 -->
<nav id="main-nav" class="fixed top-0 left-0 right-0 z-50 glass-effect nav-shadow transition-all duration-500 py-4">
    <div class="container mx-auto px-4 flex justify-between items-center">
        <!-- Logo区域 -->
        <div class="flex items-center space-x-2 focus-within:outline focus-within:outline-primary focus-within:outline-offset-2 rounded-lg">
            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-primary to-indigo-600 flex items-center justify-center text-white transition-transform duration-300 hover:scale-110">
                <i class="fas fa-heart text-xl"></i>
            </div>
            <a href="index.html" class="text-xl font-bold text-primary tracking-wide transition-colors duration-300 hover:text-indigo-600">心社区</a>
        </div>
        
        <!-- 桌面端导航菜单 - 带分组 -->
        <div class="hidden lg:flex nav-links items-center space-x-1">
            <!-- 主要服务组 -->
            <div class="flex space-x-1">
                <a href="index.html" class="nav-link {{ 'nav-link-active' if current_page == 'index' else 'nav-link-hover' }} flex items-center" aria-label="首页"><i class="fas fa-home mr-1"></i>首页</a>
                <a href="assessment_list.html" class="nav-link {{ 'nav-link-active' if current_page == 'assessment_list' else 'nav-link-hover' }} flex items-center" aria-label="心理测评"><i class="fas fa-list-alt mr-1"></i>心理测评</a>
                <a href="consultant_list.html" class="nav-link {{ 'nav-link-active' if current_page == 'consultant_list' else 'nav-link-hover' }} flex items-center" aria-label="咨询服务"><i class="fas fa-user-tie mr-1"></i>咨询服务</a>
                <a href="activity_list.html" class="nav-link {{ 'nav-link-active' if current_page == 'activity_list' else 'nav-link-hover' }} flex items-center" aria-label="团体活动"><i class="fas fa-users mr-1"></i>团体活动</a>
            </div>
            
            <!-- 辅助功能组 -->
            <div class="hidden xl:flex space-x-1">
                <span class="text-gray-300 mx-1">|</span>
                <a href="relaxation_music.html" class="nav-link {{ 'nav-link-active' if current_page == 'relaxation_music' else 'nav-link-hover' }} flex items-center" aria-label="放松体验"><i class="fas fa-music mr-1"></i>放松体验</a>
                <a href="healing_treehole.html" class="nav-link {{ 'nav-link-active' if current_page == 'healing_treehole' else 'nav-link-hover' }} flex items-center" aria-label="治愈树洞"><i class="fas fa-comments mr-1"></i>治愈树洞</a>
                <a href="sandbox_simulation_immersive.html" class="nav-link {{ 'nav-link-active' if current_page == 'sandbox_simulation_immersive' else 'nav-link-hover' }} flex items-center" aria-label="沙盘模拟"><i class="fas fa-puzzle-piece mr-1"></i>沙盘模拟</a>
                <a href="mental_stories.html" class="nav-link {{ 'nav-link-active' if current_page == 'mental_stories' else 'nav-link-hover' }} flex items-center" aria-label="心理资源"><i class="fas fa-book mr-1"></i>心理资源</a>
                <a href="mental_games.html" class="nav-link {{ 'nav-link-active' if current_page == 'mental_games' else 'nav-link-hover' }} flex items-center" aria-label="心理游戏"><i class="fas fa-gamepad mr-1"></i>心理游戏</a>
            </div>
            
            <!-- 修复后的更多服务下拉菜单 (仅在lg屏幕显示) -->
            <div class="lg:flex xl:hidden ml-2">
                <div class="relative">
                    <button id="desktop-more-menu-button" class="nav-link nav-link-hover flex items-center space-x-1 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2" aria-expanded="false">
                        <span>更多服务</span>
                        <i class="fa fa-angle-down text-sm"></i>
                    </button>
                    <div id="desktop-more-dropdown" class="hidden absolute right-0 mt-2 w-56 glass-effect rounded-lg shadow-xl z-50 py-2 dropdown-appear">
                        <a href="relaxation_music.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all duration-300">
                            <i class="fas fa-music mr-2"></i>放松体验
                        </a>
                        <a href="healing_treehole.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all duration-300">
                            <i class="fas fa-comments mr-2"></i>治愈树洞
                        </a>
                        <a href="sandbox_simulation_immersive.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all duration-300">
                            <i class="fas fa-puzzle-piece mr-2"></i>沙盘模拟
                        </a>
                        <a href="mental_stories.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all duration-300">
                            <i class="fas fa-book mr-2"></i>心理资源
                        </a>
                        <a href="mental_games.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all duration-300">
                            <i class="fas fa-gamepad mr-2"></i>心理游戏
                        </a>
                        <a href="psychology_experiments.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all duration-300">
                            <i class="fas fa-flask mr-2"></i>心理实验
                        </a>
                    </div>
                </div>
            </div>
                <div class="relative">
                    <button id="desktop-more-menu-button" class="nav-link nav-link-hover flex items-center space-x-1 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2" aria-expanded="false">
                        <span>更多</span>
                        <i class="fa fa-angle-down text-sm"></i>
                    </button>
                    <div id="desktop-more-dropdown" class="hidden absolute right-0 mt-2 w-56 glass-effect rounded-lg shadow-xl z-50 py-2 dropdown-appear">
                        <a href="relaxation_music.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all-300">
                            <i class="fas fa-music mr-2"></i>放松体验
                        </a>
                        <a href="healing_treehole.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all-300">
                            <i class="fas fa-comments mr-2"></i>治愈树洞
                        </a>
                        <a href="sandbox_simulation_immersive.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all-300">
                            <i class="fas fa-puzzle-piece mr-2"></i>沙盘模拟
                        </a>
                        <a href="mental_stories.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all-300">
                            <i class="fas fa-book mr-2"></i>心理资源
                        </a>
                        <a href="mental_games.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all-300">
                            <i class="fas fa-gamepad mr-2"></i>心理游戏
                        </a>
                        <a href="psychology_experiments.html" class="block px-4 py-3 text-gray-700 hover:bg-white/50 transition-all-300">
                            <i class="fas fa-flask mr-2"></i>心理实验
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 用户操作区域 -->
        <div class="flex items-center space-x-2">
            <!-- 桌面端：默认显示登录/注册按钮 -->
            <div id="auth-buttons" class="hidden md:flex items-center space-x-3">
                <button class="px-4 py-2 text-primary border-2 border-primary rounded-lg hover:bg-primary/5 hover:text-primary transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/30 font-medium shadow-sm hover:shadow transform hover:-translate-y-0.5 active:translate-y-0" onclick="window.location.href='login.html'">
                <i class="fas fa-sign-in-alt mr-1"></i>登录
            </button>
                <button class="px-4 py-2 bg-gradient-to-r from-primary to-indigo-600 text-white rounded-lg hover:from-indigo-600 hover:to-indigo-700 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/30 font-bold shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:translate-y-0" onclick="window.location.href='register.html'">
                <i class="fas fa-user-plus mr-2"></i>注册
            </button>
                <a href="admin_login.html" class="admin-link focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 flex items-center" aria-label="管理员入口"><i class="fas fa-cog mr-1"></i>管理员入口</a>
            </div>
            
            <!-- 桌面端：登录后显示用户菜单 -->
            <div id="user-menu" class="hidden md:flex items-center space-x-2">
                <div class="relative">
                    <button id="user-menu-button" class="flex items-center space-x-2 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 group" aria-expanded="false">
                        <div class="h-9 w-9 rounded-full bg-gradient-to-br from-primary to-indigo-600 flex items-center justify-center text-white transition-transform duration-300 hover:scale-110">
                            <i class="fas fa-user"></i>
                        </div>
                        <span id="user-name" class="text-gray-700 group-hover:text-primary transition-colors"></span>
                        <i class="fas fa-chevron-down text-gray-500 group-hover:text-primary transition-colors"></i>
                    </button>
                    <div id="user-dropdown" class="hidden absolute right-0 mt-2 w-56 glass-effect rounded-lg shadow-xl z-50 py-2 dropdown-appear">
                        <a href="user_profile.html" class="dropdown-item">
                            <i class="fas fa-user-circle mr-2"></i>个人中心
                        </a>
                        <a href="assessment_history.html" class="dropdown-item">
                            <i class="fas fa-list-alt mr-2"></i>测评记录
                        </a>
                        <a href="booking_history.html" class="dropdown-item">
                            <i class="fas fa-calendar-check mr-2"></i>预约记录
                        </a>
                        <a href="activity_registration.html" class="dropdown-item">
                            <i class="fas fa-calendar-plus mr-2"></i>活动报名
                        </a>
                        <hr class="dropdown-divider">
                        <a href="#" id="logout-button" class="dropdown-item">
                            <i class="fas fa-sign-out-alt mr-2"></i>退出登录
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- 移动端菜单按钮 -->
            <div class="md:hidden">
                <button id="mobile-menu-toggle" class="menu-toggle-button" aria-expanded="false" aria-label="打开菜单">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- 移动端导航菜单 -->
    <div id="mobile-menu" class="md:hidden hidden glass-effect animate-fade-in absolute w-full mt-1 rounded-b-xl">
        <div class="container mx-auto px-4 py-3 flex flex-col space-y-2">
            <!-- 移动端导航链接 -->
            <a href="index.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'index' else 'nav-link-hover' }} flex items-center" aria-label="首页"><i class="fas fa-home mr-2"></i>首页</a>
            <a href="assessment_list.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'assessment_list' else 'nav-link-hover' }} flex items-center" aria-label="心理测评"><i class="fas fa-list-alt mr-2"></i>心理测评</a>
            <a href="consultant_list.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'consultant_list' else 'nav-link-hover' }} flex items-center" aria-label="咨询服务"><i class="fas fa-user-tie mr-2"></i>咨询服务</a>
            <a href="activity_list.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'activity_list' else 'nav-link-hover' }} flex items-center" aria-label="团体活动"><i class="fas fa-users mr-2"></i>团体活动</a>
            <a href="relaxation_music.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'relaxation_music' else 'nav-link-hover' }} flex items-center" aria-label="放松体验"><i class="fas fa-music mr-2"></i>放松体验</a>
            <a href="healing_treehole.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'healing_treehole' else 'nav-link-hover' }} flex items-center" aria-label="治愈树洞"><i class="fas fa-comments mr-2"></i>治愈树洞</a>
            <a href="sandbox_simulation_immersive.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'sandbox_simulation_immersive' else 'nav-link-hover' }} flex items-center" aria-label="沙盘模拟"><i class="fas fa-puzzle-piece mr-2"></i>沙盘模拟</a>
            <a href="mental_stories.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'mental_stories' else 'nav-link-hover' }} flex items-center" aria-label="心理资源"><i class="fas fa-book mr-2"></i>心理资源</a>
            <a href="mental_games.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'mental_games' else 'nav-link-hover' }} flex items-center" aria-label="心理游戏"><i class="fas fa-gamepad mr-2"></i>心理游戏</a>
            <a href="psychology_experiments.html" class="mobile-nav-link {{ 'nav-link-active' if current_page == 'psychology_experiments' else 'nav-link-hover' }} flex items-center" aria-label="心理实验"><i class="fas fa-flask mr-2"></i>心理实验</a>
            
            <!-- 移动端登录/注册按钮 -->
            <div id="mobile-auth-buttons" class="flex space-x-3 py-2">
                <button class="px-4 py-2 text-primary border border-primary rounded-lg hover:bg-primary/5 hover:text-primary transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/30 font-medium shadow-sm hover:shadow transform hover:-translate-y-0.5 active:translate-y-0" onclick="window.location.href='login.html'">
                <i class="fas fa-sign-in-alt mr-1"></i>登录
            </button>
                <button class="px-4 py-2 bg-gradient-to-r from-primary to-indigo-600 text-white rounded-lg hover:from-indigo-600 hover:to-indigo-700 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/30 font-bold shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:translate-y-0" onclick="window.location.href='register.html'">
                <i class="fas fa-user-plus mr-2"></i>注册
            </button>
            </div>
            <a href="admin_login.html" class="text-center text-gray-600 hover:text-gray-800 transition-all-300 text-sm py-2" aria-label="管理员入口">管理员入口</a>
            
            <!-- 移动端用户菜单（登录后显示） -->
            <div id="mobile-user-menu" class="hidden py-2">
                <div class="flex items-center space-x-3 mb-3 pb-3 border-b border-gray-200">
                    <div class="h-10 w-10 rounded-full bg-gradient-to-br from-primary to-indigo-600 flex items-center justify-center text-white">
                        <i class="fas fa-user"></i>
                    </div>
                    <span id="mobile-user-name" class="text-gray-700 font-medium"></span>
                </div>
                <a href="user_profile.html" class="dropdown-item">
                    <i class="fas fa-user-circle mr-2"></i>个人中心
                </a>
                <a href="assessment_history.html" class="dropdown-item">
                    <i class="fas fa-list-alt mr-2"></i>测评记录
                </a>
                <a href="booking_history.html" class="dropdown-item">
                    <i class="fas fa-calendar-check mr-2"></i>预约记录
                </a>
                <a href="activity_registration.html" class="dropdown-item">
                    <i class="fas fa-calendar-plus mr-2"></i>活动报名
                </a>
                <hr class="dropdown-divider">
                <a href="#" id="mobile-logout-button" class="dropdown-item">
                    <i class="fas fa-sign-out-alt mr-2"></i>退出登录
                </a>
            </div>
        </div>
    </div>
</nav>